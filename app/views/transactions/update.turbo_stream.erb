<%= turbo_stream.replace dom_id(@transaction) do %>
  <tr class="hidden sm:table-row">
    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm text-gray-900 sm:pl-6">
      <%= @transaction.date.strftime("%b %d, %Y") %>
    </td>
    <td class="px-3 py-4 text-sm text-gray-900">
      <%= @transaction.description %>
    </td>
    <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
      <span class="inline-flex items-center">
        <span class="h-3 w-3 rounded-full mr-2" style="background-color: <%= @transaction.category_color %>"></span>
        <%= @transaction.category_name %>
      </span>
    </td>
    <td class="whitespace-nowrap px-3 py-4 text-sm font-medium <%= @transaction.income? ? 'text-green-600' : 'text-red-600' %>">
      <%= @transaction.income? ? '+' : '-' %>$<%= number_with_precision(@transaction.amount, precision: 2) %>
    </td>
    <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
      <%= link_to "Edit", edit_transaction_path(@transaction), 
          class: "text-indigo-600 hover:text-indigo-900",
          data: { turbo_frame: "modal" } %>
      <%= link_to "Delete", transaction_path(@transaction), 
          class: "ml-4 text-red-600 hover:text-red-900",
          data: { 
            turbo_method: :delete,
            turbo_confirm: "Are you sure?"
          } %>
    </td>
  </tr>
  
  <div class="sm:hidden border-b border-gray-200 bg-white px-4 py-4">
    <div class="flex items-center justify-between">
      <div class="flex-1">
        <div class="flex items-center justify-between">
          <p class="text-sm font-medium text-gray-900"><%= @transaction.description %></p>
          <p class="text-sm font-medium <%= @transaction.income? ? 'text-green-600' : 'text-red-600' %>">
            <%= @transaction.income? ? '+' : '-' %>$<%= number_with_precision(@transaction.amount, precision: 2) %>
          </p>
        </div>
        <div class="mt-1 flex items-center justify-between">
          <p class="text-xs text-gray-500"><%= @transaction.date.strftime("%b %d, %Y") %></p>
          <span class="inline-flex items-center text-xs text-gray-500">
            <span class="h-2 w-2 rounded-full mr-1" style="background-color: <%= @transaction.category_color %>"></span>
            <%= @transaction.category_name %>
          </span>
        </div>
      </div>
    </div>
    <div class="mt-2 flex space-x-3 text-xs">
      <%= link_to "Edit", edit_transaction_path(@transaction), 
          class: "text-indigo-600",
          data: { turbo_frame: "modal" } %>
      <%= link_to "Delete", transaction_path(@transaction), 
          class: "text-red-600",
          data: { 
            turbo_method: :delete,
            turbo_confirm: "Are you sure?"
          } %>
    </div>
  </div>
<% end %>

<%= turbo_stream.update "modal", "" %>

<%= turbo_stream.prepend "flash" do %>
  <div class="rounded-md bg-green-50 p-4 mb-4">
    <div class="flex">
      <div class="flex-shrink-0">
        <svg class="h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 0 .993.993 0 000 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="ml-3">
        <p class="text-sm font-medium text-green-800">
          Transaction was successfully updated.
        </p>
      </div>
    </div>
  </div>
<% end %>